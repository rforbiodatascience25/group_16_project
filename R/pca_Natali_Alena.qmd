---
title: "pca_Natali_Alena"
format: html
---

# PCA Plot

## Data Visualization

### Load Libraries

```{r}
library(tidyverse)
library(ggbiplot)
library(devtools)

```

### Tidy Data

```{r}
transp_expr <- t(expr_data)
```

```{r}
transp_expr <- data.frame(transp_expr)
```

```{r}
transp_expr <- transp_expr |>
  mutate(cancer = pheno_data$`diagnosis:ch1`)
```

```{r}
transp_expr <- transp_expr |>
  mutate(subtype = pheno_data$`tumor subtype:ch1`)
```

```{r}
transp_expr <- transp_expr |>
  filter(!is.na(cancer))
```

```{r}
transp_expr <- transp_expr |>
  filter(!is.na(subtype))
```

```{r}
transp_expr <- transp_expr|>
  mutate(subtype = if_else(subtype == "N/A", "Normal", subtype))
```

### PCA Calculation And Plotting

```{r}
expr_only <- transp_expr |>  select(-subtype, -cancer)
```

```{r}
pc <- prcomp(expr_only, center = TRUE, scale. = TRUE)
```

```{r}
ggbiplot(pc, 
         obs.scale = 1,
         var.scale = 1,
         groups = transp_expr$cancer,
         var.axes = FALSE)
```

```{r}
ggbiplot(pc, 
         obs.scale = 1,
         var.scale = 1,
         groups = transp_expr$subtype,
         var.axes = FALSE)
  
```

## Data Analysis

PCA Plots are a tool for visualizing correlation between data. Similarly behaving gene expressions are clustered. As coloring shows, the subtypes are plotted in a certain area of the graph. This means, there are patterns of gene expression within one subtype that differ generally from other subtypes. This proves clinic significance of the subtypes and enforces further analysis of the gene expression behavior.
